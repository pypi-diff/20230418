# Comparing `tmp/odoo_addon_mail_outbound_static-16.0.1.0.0.2-py3-none-any.whl.zip` & `tmp/odoo_addon_mail_outbound_static-16.0.1.0.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,23 +1,23 @@
-Zip file size: 32302 bytes, number of entries: 21
--rw-r--r--  2.0 unx     4288 b- defN 23-Mar-20 09:52 odoo/addons/mail_outbound_static/README.rst
--rw-r--r--  2.0 unx      121 b- defN 23-Mar-20 09:52 odoo/addons/mail_outbound_static/__init__.py
--rw-r--r--  2.0 unx      557 b- defN 23-Mar-20 09:52 odoo/addons/mail_outbound_static/__manifest__.py
--rw-r--r--  2.0 unx     2796 b- defN 23-Mar-20 09:52 odoo/addons/mail_outbound_static/i18n/es.po
--rw-r--r--  2.0 unx     2008 b- defN 23-Mar-20 09:52 odoo/addons/mail_outbound_static/i18n/mail_outbound_static.pot
--rw-r--r--  2.0 unx      129 b- defN 23-Mar-20 09:52 odoo/addons/mail_outbound_static/models/__init__.py
--rw-r--r--  2.0 unx     5698 b- defN 23-Mar-20 09:52 odoo/addons/mail_outbound_static/models/ir_mail_server.py
--rw-r--r--  2.0 unx      263 b- defN 23-Mar-20 09:52 odoo/addons/mail_outbound_static/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx     1331 b- defN 23-Mar-20 09:52 odoo/addons/mail_outbound_static/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx        0 b- defN 23-Mar-20 09:52 odoo/addons/mail_outbound_static/readme/ROADMAP.rst
--rw-r--r--  2.0 unx      151 b- defN 23-Mar-20 09:52 odoo/addons/mail_outbound_static/readme/USAGE.rst
--rw-r--r--  2.0 unx     9455 b- defN 23-Mar-20 09:52 odoo/addons/mail_outbound_static/static/description/icon.png
--rw-r--r--  2.0 unx    14140 b- defN 23-Mar-20 09:52 odoo/addons/mail_outbound_static/static/description/index.html
--rw-r--r--  2.0 unx      134 b- defN 23-Mar-20 09:52 odoo/addons/mail_outbound_static/tests/__init__.py
--rw-r--r--  2.0 unx     4006 b- defN 23-Mar-20 09:52 odoo/addons/mail_outbound_static/tests/test.msg
--rw-r--r--  2.0 unx    14477 b- defN 23-Mar-20 09:52 odoo/addons/mail_outbound_static/tests/test_ir_mail_server.py
--rw-r--r--  2.0 unx      677 b- defN 23-Mar-20 09:52 odoo/addons/mail_outbound_static/views/ir_mail_server_view.xml
--rw-r--r--  2.0 unx     4890 b- defN 23-Mar-20 09:52 odoo_addon_mail_outbound_static-16.0.1.0.0.2.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Mar-20 09:52 odoo_addon_mail_outbound_static-16.0.1.0.0.2.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 23-Mar-20 09:52 odoo_addon_mail_outbound_static-16.0.1.0.0.2.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2283 b- defN 23-Mar-20 09:52 odoo_addon_mail_outbound_static-16.0.1.0.0.2.dist-info/RECORD
-21 files, 67501 bytes uncompressed, 28378 bytes compressed:  58.0%
+Zip file size: 32460 bytes, number of entries: 21
+-rw-r--r--  2.0 unx     4349 b- defN 23-Apr-18 17:01 odoo/addons/mail_outbound_static/README.rst
+-rw-r--r--  2.0 unx      121 b- defN 23-Apr-18 17:01 odoo/addons/mail_outbound_static/__init__.py
+-rw-r--r--  2.0 unx      557 b- defN 23-Apr-18 17:01 odoo/addons/mail_outbound_static/__manifest__.py
+-rw-r--r--  2.0 unx     2796 b- defN 23-Apr-18 17:01 odoo/addons/mail_outbound_static/i18n/es.po
+-rw-r--r--  2.0 unx     2008 b- defN 23-Apr-18 17:01 odoo/addons/mail_outbound_static/i18n/mail_outbound_static.pot
+-rw-r--r--  2.0 unx      129 b- defN 23-Apr-18 17:01 odoo/addons/mail_outbound_static/models/__init__.py
+-rw-r--r--  2.0 unx     6036 b- defN 23-Apr-18 17:01 odoo/addons/mail_outbound_static/models/ir_mail_server.py
+-rw-r--r--  2.0 unx      324 b- defN 23-Apr-18 17:01 odoo/addons/mail_outbound_static/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx     1331 b- defN 23-Apr-18 17:01 odoo/addons/mail_outbound_static/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-18 17:01 odoo/addons/mail_outbound_static/readme/ROADMAP.rst
+-rw-r--r--  2.0 unx      151 b- defN 23-Apr-18 17:01 odoo/addons/mail_outbound_static/readme/USAGE.rst
+-rw-r--r--  2.0 unx     9455 b- defN 23-Apr-18 17:01 odoo/addons/mail_outbound_static/static/description/icon.png
+-rw-r--r--  2.0 unx    14258 b- defN 23-Apr-18 17:01 odoo/addons/mail_outbound_static/static/description/index.html
+-rw-r--r--  2.0 unx      134 b- defN 23-Apr-18 17:01 odoo/addons/mail_outbound_static/tests/__init__.py
+-rw-r--r--  2.0 unx     4006 b- defN 23-Apr-18 17:01 odoo/addons/mail_outbound_static/tests/test.msg
+-rw-r--r--  2.0 unx    14477 b- defN 23-Apr-18 17:01 odoo/addons/mail_outbound_static/tests/test_ir_mail_server.py
+-rw-r--r--  2.0 unx      677 b- defN 23-Apr-18 17:01 odoo/addons/mail_outbound_static/views/ir_mail_server_view.xml
+-rw-r--r--  2.0 unx     4949 b- defN 23-Apr-18 17:01 odoo_addon_mail_outbound_static-16.0.1.0.1.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Apr-18 17:01 odoo_addon_mail_outbound_static-16.0.1.0.1.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-Apr-18 17:01 odoo_addon_mail_outbound_static-16.0.1.0.1.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     2275 b- defN 23-Apr-18 17:01 odoo_addon_mail_outbound_static-16.0.1.0.1.dist-info/RECORD
+21 files, 68130 bytes uncompressed, 28552 bytes compressed:  58.1%
```

## zipnote {}

```diff
@@ -45,20 +45,20 @@
 
 Filename: odoo/addons/mail_outbound_static/tests/test_ir_mail_server.py
 Comment: 
 
 Filename: odoo/addons/mail_outbound_static/views/ir_mail_server_view.xml
 Comment: 
 
-Filename: odoo_addon_mail_outbound_static-16.0.1.0.0.2.dist-info/METADATA
+Filename: odoo_addon_mail_outbound_static-16.0.1.0.1.dist-info/METADATA
 Comment: 
 
-Filename: odoo_addon_mail_outbound_static-16.0.1.0.0.2.dist-info/WHEEL
+Filename: odoo_addon_mail_outbound_static-16.0.1.0.1.dist-info/WHEEL
 Comment: 
 
-Filename: odoo_addon_mail_outbound_static-16.0.1.0.0.2.dist-info/top_level.txt
+Filename: odoo_addon_mail_outbound_static-16.0.1.0.1.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo_addon_mail_outbound_static-16.0.1.0.0.2.dist-info/RECORD
+Filename: odoo_addon_mail_outbound_static-16.0.1.0.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/mail_outbound_static/README.rst

```diff
@@ -87,14 +87,17 @@
 
 * Frédéric Garbely <frederic.garbely@braintec-group.com>
 * Dave Lasley <dave@laslabs.com>
 * Lorenzo Battistini <https://github.com/eLBati>
 * Pierre Pizzetta <pierre@devreaction.com>
 * Katherine Zaoral <kz@adhoc.com.ar>
 * Juan José Scarafía <jjs@adhoc.com.ar>
+* `Quartile <https://www.quartile.co>`__:
+
+  * Yoshi Tashiro
 
 Maintainers
 ~~~~~~~~~~~
 
 This module is maintained by the OCA.
 
 .. image:: https://odoo-community.org/logo.png
```

## odoo/addons/mail_outbound_static/__manifest__.py

```diff
@@ -1,14 +1,14 @@
 # Copyright 2016-2022 LasLabs Inc.
 # License LGPL-3.0 or later (http://www.gnu.org/licenses/lgpl.html).
 
 {
     "name": "Mail Outbound Static",
     "summary": "Allows you to configure the from header for a mail server.",
-    "version": "16.0.1.0.0",
+    "version": "16.0.1.0.1",
     "category": "Discuss",
     "website": "https://github.com/OCA/social",
     "author": "brain-tec AG, LasLabs, Adhoc SA, Odoo Community Association (OCA)",
     "license": "LGPL-3",
     "application": False,
     "installable": True,
     "depends": ["base"],
```

## odoo/addons/mail_outbound_static/models/ir_mail_server.py

```diff
@@ -63,59 +63,64 @@
 
     @api.model
     def _get_domain_whitelist(self, domain_whitelist_string):
         res = domain_whitelist_string.split(",") if domain_whitelist_string else []
         res = [item.strip() for item in res]
         return res
 
+    def _prepare_email_message(self, message, smtp_session):
+        smtp_from, smtp_to_list, message = super()._prepare_email_message(
+            message, smtp_session
+        )
+        name_from = self._context.get("name_from")
+        email_from = self._context.get("email_from")
+        email_domain = self._context.get("email_domain")
+        mail_server = self.browse(self._context.get("mail_server_id"))
+        domain_whitelist = mail_server.domain_whitelist or tools.config.get(
+            "smtp_domain_whitelist"
+        )
+        domain_whitelist = self._get_domain_whitelist(domain_whitelist)
+        # Replace the From only if needed
+        if mail_server.smtp_from and (
+            not domain_whitelist or email_domain not in domain_whitelist
+        ):
+            email_from = formataddr((name_from, mail_server.smtp_from))
+            message.replace_header("From", email_from)
+            smtp_from = email_from
+            if not self._get_default_bounce_address():
+                # then, bounce handling is disabled and we want
+                # Return-Path = From
+                if "Return-Path" in message:
+                    message.replace_header("Return-Path", email_from)
+                else:
+                    message.add_header("Return-Path", email_from)
+        return smtp_from, smtp_to_list, message
+
     @api.model
     def send_email(
         self, message, mail_server_id=None, smtp_server=None, *args, **kwargs
     ):
         # Get email_from and name_from
         if message["From"].count("<") > 1:
             split_from = message["From"].rsplit(" <", 1)
             name_from = split_from[0]
             email_from = split_from[-1].replace(">", "")
         else:
             name_from, email_from = parseaddr(message["From"])
-
         email_domain = email_from.split("@")[1]
-
         # Replicate logic from core to get mail server
         # Get proper mail server to use
         if not smtp_server and not mail_server_id:
             mail_server_id = self._get_mail_sever(email_domain)
-
-        # If not mail sever defined use smtp_from defined in odoo config
-        if mail_server_id:
-            mail_server = self.sudo().browse(mail_server_id)
-            domain_whitelist = mail_server.domain_whitelist
-            smtp_from = mail_server.smtp_from
-        else:
-            domain_whitelist = tools.config.get("smtp_domain_whitelist")
-            smtp_from = tools.config.get("smtp_from")
-
-        domain_whitelist = self._get_domain_whitelist(domain_whitelist)
-
-        # Replace the From only if needed
-        if smtp_from and (not domain_whitelist or email_domain not in domain_whitelist):
-            email_from = formataddr((name_from, smtp_from))
-            message.replace_header("From", email_from)
-            bounce_alias = (
-                self.env["ir.config_parameter"].sudo().get_param("mail.bounce.alias")
-            )
-            if not bounce_alias:
-                # then, bounce handling is disabled and we want
-                # Return-Path = From
-                if "Return-Path" in message:
-                    message.replace_header("Return-Path", email_from)
-                else:
-                    message.add_header("Return-Path", email_from)
-
+        self = self.with_context(
+            name_from=name_from,
+            email_from=email_from,
+            email_domain=email_domain,
+            mail_server_id=mail_server_id,
+        )
         return super(IrMailServer, self).send_email(
             message, mail_server_id, smtp_server, *args, **kwargs
         )
 
     @tools.ormcache("email_domain")
     def _get_mail_sever(self, email_domain):
         """return the mail server id that match with the domain_whitelist
```

## odoo/addons/mail_outbound_static/readme/CONTRIBUTORS.rst

```diff
@@ -1,6 +1,9 @@
 * Frédéric Garbely <frederic.garbely@braintec-group.com>
 * Dave Lasley <dave@laslabs.com>
 * Lorenzo Battistini <https://github.com/eLBati>
 * Pierre Pizzetta <pierre@devreaction.com>
 * Katherine Zaoral <kz@adhoc.com.ar>
 * Juan José Scarafía <jjs@adhoc.com.ar>
+* `Quartile <https://www.quartile.co>`__:
+
+  * Yoshi Tashiro
```

## odoo/addons/mail_outbound_static/static/description/index.html

### odoo/addons/mail_outbound_static/static/description/index.html

```diff
@@ -511,14 +511,21 @@
               &gt;
             </li>
             <li>
               Juan José Scarafía &lt;
               <a class="reference external" href="mailto:jjs@adhoc.com.ar">jjs@adhoc.com.ar</a>
               &gt;
             </li>
+            <li>
+              <a class="reference external" href="https://www.quartile.co">Quartile</a>
+              :
+              <ul>
+                <li>Yoshi Tashiro</li>
+              </ul>
+            </li>
           </ul>
         </div>
         <div class="section" id="maintainers">
           <h2>
             <a class="toc-backref" href="#id6">Maintainers</a>
           </h2>
           <p>This module is maintained by the OCA.</p>
```

## Comparing `odoo_addon_mail_outbound_static-16.0.1.0.0.2.dist-info/METADATA` & `odoo_addon_mail_outbound_static-16.0.1.0.1.dist-info/METADATA`

 * *Files 3% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo-addon-mail-outbound-static
-Version: 16.0.1.0.0.2
+Version: 16.0.1.0.1
 Summary: Allows you to configure the from header for a mail server.
 Home-page: https://github.com/OCA/social
 Author: brain-tec AG, LasLabs, Adhoc SA, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: LGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
@@ -103,14 +103,17 @@
 
 * Frédéric Garbely <frederic.garbely@braintec-group.com>
 * Dave Lasley <dave@laslabs.com>
 * Lorenzo Battistini <https://github.com/eLBati>
 * Pierre Pizzetta <pierre@devreaction.com>
 * Katherine Zaoral <kz@adhoc.com.ar>
 * Juan José Scarafía <jjs@adhoc.com.ar>
+* `Quartile <https://www.quartile.co>`__:
+
+  * Yoshi Tashiro
 
 Maintainers
 ~~~~~~~~~~~
 
 This module is maintained by the OCA.
 
 .. image:: https://odoo-community.org/logo.png
```

## Comparing `odoo_addon_mail_outbound_static-16.0.1.0.0.2.dist-info/RECORD` & `odoo_addon_mail_outbound_static-16.0.1.0.1.dist-info/RECORD`

 * *Files 8% similar despite different names*

```diff
@@ -1,21 +1,21 @@
-odoo/addons/mail_outbound_static/README.rst,sha256=eEk7rcUk-JIzuojFQ2Vd67tUeJGgrxkm40XWHiD3-ds,4288
+odoo/addons/mail_outbound_static/README.rst,sha256=9Ipu3lCx5660Xomf9wTbn3Ig_4Q2ZYPdNH3xsKV1DHk,4349
 odoo/addons/mail_outbound_static/__init__.py,sha256=CkOQ259kr2yYanJzYR5FLBF0owzb5NZT8WGXsBP8nyI,121
-odoo/addons/mail_outbound_static/__manifest__.py,sha256=2_CmIfSQDJuoFGmVzlgIZhRio9TdhtgvM9x4QyPi_ls,557
+odoo/addons/mail_outbound_static/__manifest__.py,sha256=-td6qnDDqhTtTEyFu5FB_ER_bWEW--39dHtrvpuvq18,557
 odoo/addons/mail_outbound_static/i18n/es.po,sha256=V09Ao9Q3wGQ9yP9okRN3rzLBaXAWLpHqsbdyCc9VrC8,2796
 odoo/addons/mail_outbound_static/i18n/mail_outbound_static.pot,sha256=q_QXxquodKrkBWCnXNA0A_D1s9saPD8eZh3SbPPKECo,2008
 odoo/addons/mail_outbound_static/models/__init__.py,sha256=e_cLUFflptobVa0TPBKlqEm2gwa9pDEks2PIGR4SwWU,129
-odoo/addons/mail_outbound_static/models/ir_mail_server.py,sha256=QIkFVDm8-0wCXTHd9MJ0PLxOAlfrbyBqYh9GSFdRo8U,5698
-odoo/addons/mail_outbound_static/readme/CONTRIBUTORS.rst,sha256=8CQwMCgXV4vBA3foWlIAFq9R7sw7AJIKldAIYDFcqns,263
+odoo/addons/mail_outbound_static/models/ir_mail_server.py,sha256=hGF_AFmk2jK9Sp9qe6WQuZjTWm8F1cdiOqvXMFncTrI,6036
+odoo/addons/mail_outbound_static/readme/CONTRIBUTORS.rst,sha256=QhDukDu5EN631fc2N1W8BCA9qTq1TzzxeodNghnuAH0,324
 odoo/addons/mail_outbound_static/readme/DESCRIPTION.rst,sha256=jfIgznsTnKjRSOfACkghbEoDP3Lhvtjj0vcHBtxX_0Q,1331
 odoo/addons/mail_outbound_static/readme/ROADMAP.rst,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 odoo/addons/mail_outbound_static/readme/USAGE.rst,sha256=yyl9TOHgFVSohX8GSsuaY6T4heynd-JAlD-x6uP8ruY,151
 odoo/addons/mail_outbound_static/static/description/icon.png,sha256=6xBPJauaFOF0KDHfHgQopSc28kKvxMaeoQFQWZtfZDo,9455
-odoo/addons/mail_outbound_static/static/description/index.html,sha256=XQtusztkpbWsrBG5lnTKZN5zI7V0EDra3Jervz_J_pQ,14140
+odoo/addons/mail_outbound_static/static/description/index.html,sha256=czjT8qYnEL7ALxNDhsIh6HdxCWwVeLeWN-2E85hW5vk,14258
 odoo/addons/mail_outbound_static/tests/__init__.py,sha256=67XPOtwY4s0XABkfEz0wxtjpVUZzLVHaReqSjyET-5s,134
 odoo/addons/mail_outbound_static/tests/test.msg,sha256=5LIGAuEnZHr9HUK_DRmC1BhMSIAd4k1ye478B-iRFwQ,4006
 odoo/addons/mail_outbound_static/tests/test_ir_mail_server.py,sha256=lbSp8C3SKrAtsAnz4zeKpB1YHtewdVoGozr71nl0iMc,14477
 odoo/addons/mail_outbound_static/views/ir_mail_server_view.xml,sha256=Wva0QPPqaag5o2-T5xr53-O10xnmzdsJSkVDCBLgX30,677
-odoo_addon_mail_outbound_static-16.0.1.0.0.2.dist-info/METADATA,sha256=men_pcRgptqttl9vLktnT9txkYYNe6afVyUJHRzb3kQ,4890
-odoo_addon_mail_outbound_static-16.0.1.0.0.2.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
-odoo_addon_mail_outbound_static-16.0.1.0.0.2.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo_addon_mail_outbound_static-16.0.1.0.0.2.dist-info/RECORD,,
+odoo_addon_mail_outbound_static-16.0.1.0.1.dist-info/METADATA,sha256=DVB9dc_za3NDMc1TUxBf8I0TX4f5xhH-hwUNBgCJbSc,4949
+odoo_addon_mail_outbound_static-16.0.1.0.1.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
+odoo_addon_mail_outbound_static-16.0.1.0.1.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo_addon_mail_outbound_static-16.0.1.0.1.dist-info/RECORD,,
```

