# Comparing `tmp/karrio.server.events-2023.3.4-py3-none-any.whl.zip` & `tmp/karrio.server.events-2023.4-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,45 +1,46 @@
-Zip file size: 29344 bytes, number of entries: 43
+Zip file size: 30214 bytes, number of entries: 44
 -rw-rw-r--  2.0 unx      144 b- defN 22-Nov-15 19:21 karrio/server/events/__init__.py
 -rw-rw-r--  2.0 unx       63 b- defN 22-Nov-15 19:21 karrio/server/events/admin.py
 -rw-rw-r--  2.0 unx      301 b- defN 22-Nov-15 19:21 karrio/server/events/apps.py
 -rw-rw-r--  2.0 unx     2230 b- defN 23-Mar-03 13:50 karrio/server/events/filters.py
 -rw-rw-r--  2.0 unx     2439 b- defN 23-Mar-03 13:50 karrio/server/events/models.py
 -rw-rw-r--  2.0 unx       95 b- defN 22-Nov-15 19:21 karrio/server/events/router.py
--rw-rw-r--  2.0 unx     3914 b- defN 23-Mar-18 11:05 karrio/server/events/signals.py
+-rw-rw-r--  2.0 unx     4509 b- defN 23-Apr-16 10:41 karrio/server/events/signals.py
 -rw-rw-r--  2.0 unx      712 b- defN 23-Mar-03 13:50 karrio/server/events/tasks.py
 -rw-rw-r--  2.0 unx       60 b- defN 22-Nov-15 19:21 karrio/server/events/tests.py
 -rw-rw-r--  2.0 unx      217 b- defN 22-Nov-15 19:21 karrio/server/events/urls.py
 -rw-rw-r--  2.0 unx     2212 b- defN 23-Mar-03 13:50 karrio/server/events/migrations/0001_initial.py
 -rw-rw-r--  2.0 unx     1620 b- defN 22-Nov-15 19:21 karrio/server/events/migrations/0002_event.py
 -rw-rw-r--  2.0 unx      813 b- defN 22-Nov-15 19:21 karrio/server/events/migrations/0003_auto_20220303_1210.py
--rw-rw-r--  2.0 unx     1284 b- defN 23-Mar-03 13:50 karrio/server/events/migrations/0004_custom_migration_2022_4.py
+-rw-rw-r--  2.0 unx     1305 b- defN 23-Apr-18 09:49 karrio/server/events/migrations/0004_custom_migration_2022_4.py
 -rw-rw-r--  2.0 unx      513 b- defN 22-Nov-15 19:21 karrio/server/events/migrations/0005_event_event_object_idx.py
 -rw-rw-r--  2.0 unx     2880 b- defN 23-Mar-03 13:50 karrio/server/events/migrations/0006_webhook_events_alter_event_data.py
--rw-rw-r--  2.0 unx      770 b- defN 23-Mar-03 13:50 karrio/server/events/migrations/0007_auto_20221130_0255.py
+-rw-rw-r--  2.0 unx      780 b- defN 23-Apr-18 09:49 karrio/server/events/migrations/0007_auto_20221130_0255.py
 -rw-rw-r--  2.0 unx      397 b- defN 23-Mar-03 13:50 karrio/server/events/migrations/0008_alter_event_type.py
+-rw-rw-r--  2.0 unx     1825 b- defN 23-Apr-18 10:18 karrio/server/events/migrations/0009_alter_webhook_enabled_events.py
 -rw-rw-r--  2.0 unx        0 b- defN 22-Nov-15 19:21 karrio/server/events/migrations/__init__.py
 -rw-rw-r--  2.0 unx       52 b- defN 23-Mar-03 13:50 karrio/server/events/serializers/__init__.py
--rw-rw-r--  2.0 unx     1963 b- defN 22-Nov-15 19:21 karrio/server/events/serializers/base.py
+-rw-rw-r--  2.0 unx     2139 b- defN 23-Apr-16 10:42 karrio/server/events/serializers/base.py
 -rw-rw-r--  2.0 unx      289 b- defN 22-Nov-15 19:21 karrio/server/events/serializers/event.py
 -rw-rw-r--  2.0 unx      713 b- defN 23-Mar-03 13:50 karrio/server/events/serializers/webhook.py
 -rw-rw-r--  2.0 unx       81 b- defN 22-Nov-15 19:21 karrio/server/events/task_definitions/__init__.py
 -rw-rw-r--  2.0 unx     1755 b- defN 23-Mar-18 11:05 karrio/server/events/task_definitions/base/__init__.py
 -rw-rw-r--  2.0 unx     2257 b- defN 23-Mar-16 00:07 karrio/server/events/task_definitions/base/archiving.py
--rw-rw-r--  2.0 unx     7306 b- defN 23-Mar-29 11:42 karrio/server/events/task_definitions/base/tracking.py
+-rw-rw-r--  2.0 unx     7306 b- defN 23-Mar-29 20:04 karrio/server/events/task_definitions/base/tracking.py
 -rw-rw-r--  2.0 unx     3506 b- defN 23-Mar-03 13:50 karrio/server/events/task_definitions/base/webhook.py
 -rw-rw-r--  2.0 unx      220 b- defN 22-Nov-15 19:21 karrio/server/events/tests/__init__.py
 -rw-rw-r--  2.0 unx     4066 b- defN 23-Mar-03 13:50 karrio/server/events/tests/test_events.py
--rw-rw-r--  2.0 unx     8665 b- defN 23-Mar-29 13:22 karrio/server/events/tests/test_tracking_tasks.py
+-rw-rw-r--  2.0 unx     8665 b- defN 23-Mar-29 20:04 karrio/server/events/tests/test_tracking_tasks.py
 -rw-rw-r--  2.0 unx     3860 b- defN 22-Nov-15 19:21 karrio/server/events/tests/test_webhooks.py
 -rw-rw-r--  2.0 unx       90 b- defN 22-Nov-15 19:21 karrio/server/events/views/__init__.py
 -rw-rw-r--  2.0 unx     4969 b- defN 23-Mar-03 13:50 karrio/server/events/views/webhooks.py
 -rw-rw-r--  2.0 unx       81 b- defN 23-Mar-03 13:50 karrio/server/graph/schemas/__init__.py
 -rw-rw-r--  2.0 unx     1620 b- defN 23-Mar-03 13:50 karrio/server/graph/schemas/events/__init__.py
 -rw-rw-r--  2.0 unx     1526 b- defN 23-Mar-03 13:50 karrio/server/graph/schemas/events/inputs.py
 -rw-rw-r--  2.0 unx     1862 b- defN 23-Mar-03 13:50 karrio/server/graph/schemas/events/mutations.py
 -rw-rw-r--  2.0 unx     2759 b- defN 23-Mar-03 13:50 karrio/server/graph/schemas/events/types.py
--rw-rw-r--  2.0 unx      681 b- defN 23-Mar-29 13:38 karrio.server.events-2023.3.4.dist-info/METADATA
--rw-rw-r--  2.0 unx       92 b- defN 23-Mar-29 13:38 karrio.server.events-2023.3.4.dist-info/WHEEL
--rw-rw-r--  2.0 unx        7 b- defN 23-Mar-29 13:38 karrio.server.events-2023.3.4.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     4254 b- defN 23-Mar-29 13:38 karrio.server.events-2023.3.4.dist-info/RECORD
-43 files, 73338 bytes uncompressed, 22272 bytes compressed:  69.6%
+-rw-rw-r--  2.0 unx      679 b- defN 23-Apr-18 10:32 karrio.server.events-2023.4.dist-info/METADATA
+-rw-rw-r--  2.0 unx       92 b- defN 23-Apr-18 10:32 karrio.server.events-2023.4.dist-info/WHEEL
+-rw-rw-r--  2.0 unx        7 b- defN 23-Apr-18 10:32 karrio.server.events-2023.4.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     4371 b- defN 23-Apr-18 10:32 karrio.server.events-2023.4.dist-info/RECORD
+44 files, 76080 bytes uncompressed, 22946 bytes compressed:  69.8%
```

## zipnote {}

```diff
@@ -48,14 +48,17 @@
 
 Filename: karrio/server/events/migrations/0007_auto_20221130_0255.py
 Comment: 
 
 Filename: karrio/server/events/migrations/0008_alter_event_type.py
 Comment: 
 
+Filename: karrio/server/events/migrations/0009_alter_webhook_enabled_events.py
+Comment: 
+
 Filename: karrio/server/events/migrations/__init__.py
 Comment: 
 
 Filename: karrio/server/events/serializers/__init__.py
 Comment: 
 
 Filename: karrio/server/events/serializers/base.py
@@ -111,20 +114,20 @@
 
 Filename: karrio/server/graph/schemas/events/mutations.py
 Comment: 
 
 Filename: karrio/server/graph/schemas/events/types.py
 Comment: 
 
-Filename: karrio.server.events-2023.3.4.dist-info/METADATA
+Filename: karrio.server.events-2023.4.dist-info/METADATA
 Comment: 
 
-Filename: karrio.server.events-2023.3.4.dist-info/WHEEL
+Filename: karrio.server.events-2023.4.dist-info/WHEEL
 Comment: 
 
-Filename: karrio.server.events-2023.3.4.dist-info/top_level.txt
+Filename: karrio.server.events-2023.4.dist-info/top_level.txt
 Comment: 
 
-Filename: karrio.server.events-2023.3.4.dist-info/RECORD
+Filename: karrio.server.events-2023.4.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## karrio/server/events/signals.py

```diff
@@ -31,20 +31,42 @@
     is_bound = "created_at" in (update_fields or [])
     status_updated = "status" in (update_fields or [])
 
     if created:
         return
     if is_bound and instance.status == serializers.ShipmentStatus.purchased.value:
         event = EventTypes.shipment_purchased.value
-    elif status_updated and instance.status == serializers.ShipmentStatus.purchased.value:
+    elif (
+        status_updated and instance.status == serializers.ShipmentStatus.purchased.value
+    ):
         event = EventTypes.shipment_purchased.value
-    elif status_updated and instance.status == serializers.ShipmentStatus.in_transit.value:
+    elif (
+        status_updated
+        and instance.status == serializers.ShipmentStatus.in_transit.value
+    ):
         event = EventTypes.shipment_fulfilled.value
-    elif status_updated and instance.status == serializers.ShipmentStatus.cancelled.value:
+    elif (
+        status_updated and instance.status == serializers.ShipmentStatus.cancelled.value
+    ):
         event = EventTypes.shipment_cancelled.value
+    elif (
+        status_updated
+        and instance.status == serializers.ShipmentStatus.out_for_delivery.value
+    ):
+        event = EventTypes.shipment_out_for_delivery.value
+    elif (
+        status_updated
+        and instance.status == serializers.ShipmentStatus.needs_attention.value
+    ):
+        event = EventTypes.shipment_needs_attention.value
+    elif (
+        status_updated
+        and instance.status == serializers.ShipmentStatus.delivery_failed.value
+    ):
+        event = EventTypes.shipment_delivery_failed.value
     else:
         return
 
     data = serializers.Shipment(instance).data
     event_at = instance.updated_at
     context = dict(
         test_mode=instance.test_mode,
```

## karrio/server/events/migrations/0004_custom_migration_2022_4.py

```diff
@@ -4,39 +4,38 @@
 
 
 def forwards_func(apps, schema_editor):
     db_alias = schema_editor.connection.alias
     Event = apps.get_model("events", "Event")
     Webhook = apps.get_model("events", "Webhook")
 
-    for event in Event.objects.using(db_alias).filter(type__icontains="."):
+    for event in Event.objects.using(db_alias).filter(type__icontains=".").iterator():
         event.type = event.type.replace(".", "_")
         event.save()
 
     for webhook in Webhook.objects.using(db_alias).all():
         webhook.enabled_events = [e.replace(".", "_") for e in webhook.enabled_events]
         webhook.save()
 
 
 def reverse_func(apps, schema_editor):
     db_alias = schema_editor.connection.alias
     Event = apps.get_model("events", "Event")
     Webhook = apps.get_model("events", "Webhook")
 
-    for event in Event.objects.using(db_alias).filter(type__icontains="."):
+    for event in Event.objects.using(db_alias).filter(type__icontains=".").iterator():
         event.type = event.type.replace("_", ".")
         event.save()
 
     for webhook in Webhook.objects.using(db_alias).all():
         webhook.enabled_events = [e.replace("_", ".") for e in webhook.enabled_events]
         webhook.save()
 
 
 class Migration(migrations.Migration):
-
     dependencies = [
         ("events", "0003_auto_20220303_1210"),
     ]
 
     operations = [
         migrations.RunPython(forwards_func, reverse_func),
     ]
```

## karrio/server/events/migrations/0007_auto_20221130_0255.py

```diff
@@ -5,27 +5,26 @@
 
 
 def forwards_func(apps, schema_editor):
     db_alias = schema_editor.connection.alias
     Webhook = apps.get_model("events", "Webhook")
     _webhooks = []
 
-    for webhook in Webhook.objects.using(db_alias).all():
+    for webhook in Webhook.objects.using(db_alias).all().iterator():
         webhook.enabled_events = lib.to_dict(webhook.enabled_events)
         _webhooks.append(webhook)
 
     Webhook.objects.using(db_alias).bulk_update(_webhooks, ["enabled_events"])
 
 
 def reverse_func(apps, schema_editor):
     pass
 
 
 class Migration(migrations.Migration):
-
     dependencies = [
         ("events", "0006_webhook_events_alter_event_data"),
     ]
 
     operations = [
         migrations.RunPython(forwards_func, reverse_func),
     ]
```

## karrio/server/events/serializers/base.py

```diff
@@ -4,14 +4,17 @@
 
 
 class EventTypes(Enum):
     all = "all"
     shipment_purchased = "shipment_purchased"
     shipment_cancelled = "shipment_cancelled"
     shipment_fulfilled = "shipment_fulfilled"
+    shipment_out_for_delivery = "shipment_out_for_delivery"
+    shipment_needs_attention = "shipment_needs_attention"
+    shipment_delivery_failed = "shipment_delivery_failed"
     tracker_created = "tracker_created"
     tracker_updated = "tracker_updated"
     order_created = "order_created"
     order_updated = "order_updated"
     order_fulfilled = "order_fulfilled"
     order_cancelled = "order_cancelled"
     order_delivered = "order_delivered"
```

## Comparing `karrio.server.events-2023.3.4.dist-info/METADATA` & `karrio.server.events-2023.4.dist-info/METADATA`

 * *Files 16% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: karrio.server.events
-Version: 2023.3.4
+Version: 2023.4
 Summary: Multi-carrier shipping API Events module
 Home-page: https://github.com/karrioapi/karrio
 Author: karrio
 Author-email: hello@karrio.io
 License: Apache-2.0
 Platform: UNKNOWN
 Classifier: Programming Language :: Python :: 3
```

## Comparing `karrio.server.events-2023.3.4.dist-info/RECORD` & `karrio.server.events-2023.4.dist-info/RECORD`

 * *Files 6% similar despite different names*

```diff
@@ -1,28 +1,29 @@
 karrio/server/events/__init__.py,sha256=tvia3JfJUbr8axL76i0ic308Q0623SVKOyg0FXP3hBA,144
 karrio/server/events/admin.py,sha256=suMo4x8I3JBxAFBVIdE-5qnqZ6JAZV0FESABHOSc-vg,63
 karrio/server/events/apps.py,sha256=DIV8JdPB_3hD4DwhcQTevhph3PaceMkFSEGM1lOcdVY,301
 karrio/server/events/filters.py,sha256=vMeY42IsoFl482-yX1BI17sw-9x9euOnzTl-860W3sg,2230
 karrio/server/events/models.py,sha256=Ze4ITStRy_eb7qtujYbq7IISxvo7V2SKcmdCQ4fQO2I,2439
 karrio/server/events/router.py,sha256=IBUR7rfBkdEHQzWxYOPcVSM8NBp3fte9G6Q5BVTUNNw,95
-karrio/server/events/signals.py,sha256=APi14Kmcj6tJbBX_ubKAYk7YaoG1AFx8DaCMkNakeps,3914
+karrio/server/events/signals.py,sha256=8P3pwo8UCCh5nbhNxP2vrbFlnrmEP7SbaRm5WNaIyM4,4509
 karrio/server/events/tasks.py,sha256=RVLJ2cNEQnT-3bUoitw9C_ST6g7tlLyzuJvu8omLOHc,712
 karrio/server/events/tests.py,sha256=mrbGGRNg5jwbTJtWWa7zSKdDyeB4vmgZCRc2nk6VY-g,60
 karrio/server/events/urls.py,sha256=oLTTzDWPhEFfK93EvzHTDRxqkw8Fr3iXneDXwFUkvcU,217
 karrio/server/events/migrations/0001_initial.py,sha256=c_HS1Pt89fnDgc839eh2VGBN4mvICBGWH5OUC5Xsz8k,2212
 karrio/server/events/migrations/0002_event.py,sha256=2f4SCoJcRXhPQRelH3EVRgpN77J0UmAW5yAtvvk42nc,1620
 karrio/server/events/migrations/0003_auto_20220303_1210.py,sha256=aOqf2v9w1DgfDKTWWkP94EDFhL7pg_LjeNEIl7-XdPw,813
-karrio/server/events/migrations/0004_custom_migration_2022_4.py,sha256=8bdQYkhmb7a5tPHQ_o_I-uO1_bCRe6_820zWh0zZ3WE,1284
+karrio/server/events/migrations/0004_custom_migration_2022_4.py,sha256=PjOvHs363wqVuYegVbDScEiw_iX9PHvg9fkviJaxcCI,1305
 karrio/server/events/migrations/0005_event_event_object_idx.py,sha256=UsDbq4z4n7wY4QyehzLy_9NP6GCejCqZAF9uizeh6Ng,513
 karrio/server/events/migrations/0006_webhook_events_alter_event_data.py,sha256=NJsoOUOEtarDO-7LCnrh8nxKmjyhe_mw-RhSIKDlYC0,2880
-karrio/server/events/migrations/0007_auto_20221130_0255.py,sha256=TNK37wH0ra2xCkNZShGucFqSmledEA2lYa0p5dbZ6ko,770
+karrio/server/events/migrations/0007_auto_20221130_0255.py,sha256=o5tkTj6vzrqpOyX6mXAYS3GOYlDRMkMY4tcPxzOzvOc,780
 karrio/server/events/migrations/0008_alter_event_type.py,sha256=DhUAI-yG_ugEv4f9oigdhn1lH_6A2nV8GyS-N63cmdQ,397
+karrio/server/events/migrations/0009_alter_webhook_enabled_events.py,sha256=0bhn3Ab_4cW2Zjptw7yfKJT1iTnsrBl_7goCCquNzcQ,1825
 karrio/server/events/migrations/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 karrio/server/events/serializers/__init__.py,sha256=S5KJONM1VFbB_Wyl__F2YbdSV7R_5RPNFos0ERkfDko,52
-karrio/server/events/serializers/base.py,sha256=dRNtw2XW5ih237cuSOaAyFOjW1iZciC9evUoOZZ6ctk,1963
+karrio/server/events/serializers/base.py,sha256=srecDHVUafF12q6Sh8I9d7ZzwqwgKoZkA6JIMxX1zLY,2139
 karrio/server/events/serializers/event.py,sha256=dKYqldfSEjKMY7uB1rBFfEfSZ_dfEp8EPxbkBBSWzcc,289
 karrio/server/events/serializers/webhook.py,sha256=gOu6mFbloVVbS1XuOHG6sFjBpLmo0byvuG6aVEQVK5M,713
 karrio/server/events/task_definitions/__init__.py,sha256=bpT73UG7mZL_JjEqMwbYx6q69jA8J5Jcoul1LcDokhA,81
 karrio/server/events/task_definitions/base/__init__.py,sha256=UTEadJeDg9cHBpra9n1bp4cowoQRwIykgsIg02Yu0e8,1755
 karrio/server/events/task_definitions/base/archiving.py,sha256=flbcxmD1pKlzCrYvekbwJ7Dvz4TaLdudAAsWH8JAjzI,2257
 karrio/server/events/task_definitions/base/tracking.py,sha256=q2vrN0VK2jW243-EwPQkV1wHkG4g6Qr1MSjjoNQQSBE,7306
 karrio/server/events/task_definitions/base/webhook.py,sha256=NgXMJw_55pwZ5z4bu49VUekFNkUJ_cwvs01PNnLxhI4,3506
@@ -33,11 +34,11 @@
 karrio/server/events/views/__init__.py,sha256=Y4hfjd_YSOHj6L7oH41bssVW8rXI_l4vD_IthfNuJ2o,90
 karrio/server/events/views/webhooks.py,sha256=6WAxjzss4SrWC_yPQlnv4CnIvfaIiev9zhRFuw45WTs,4969
 karrio/server/graph/schemas/__init__.py,sha256=iOEMwnlORWezdO8-2vxBIPSR37D7JGjluZ8f55vzxls,81
 karrio/server/graph/schemas/events/__init__.py,sha256=Yg1rWew5DgSb_OnLy8n7qqwPLfVcZ1xm0_VzqP04rlE,1620
 karrio/server/graph/schemas/events/inputs.py,sha256=Mgy9qCUrbL-sMI5dNXsnbW8K5_PnGKM13brzZrc5OWk,1526
 karrio/server/graph/schemas/events/mutations.py,sha256=930g2D5TnAEgEjfEfLml1Q9OGCyxe2D592BhzSGDQAQ,1862
 karrio/server/graph/schemas/events/types.py,sha256=TPlrDwQV4LZXu-1t4gFl_eYayU39THmgYT3uv7VXnnw,2759
-karrio.server.events-2023.3.4.dist-info/METADATA,sha256=jWf3MuOUr99u1sauEyCtnyaS3NhZmRyqaVSzLOtkOHo,681
-karrio.server.events-2023.3.4.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-karrio.server.events-2023.3.4.dist-info/top_level.txt,sha256=mfkVZXzNuVRmA7NRlck_Ub-C8Zgtqxbx3gX1Rq_W-i0,7
-karrio.server.events-2023.3.4.dist-info/RECORD,,
+karrio.server.events-2023.4.dist-info/METADATA,sha256=w2ZzA7fqDrUP6ImlA6Rilr5at1E0HlE-WERR_6sMzhM,679
+karrio.server.events-2023.4.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+karrio.server.events-2023.4.dist-info/top_level.txt,sha256=mfkVZXzNuVRmA7NRlck_Ub-C8Zgtqxbx3gX1Rq_W-i0,7
+karrio.server.events-2023.4.dist-info/RECORD,,
```

